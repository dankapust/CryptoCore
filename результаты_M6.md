# ## üìä –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Sprint 6 (M6)

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ |
| ---------- | ------ | -------------- |
| **STR-1**  | ‚úÖ     | –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è M1‚ÄìM5 |
| **STR-2**  | ‚úÖ     | `pycryptocore/modes/gcm.py`, `__init__.py` |
| **STR-3**  | ‚úÖ     | README.md: GCM, AAD, –ø—Ä–∏–º–µ—Ä—ã, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è |
| **STR-4**  | ‚úÖ     | –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ –ø—Ä–æ–µ–∫—Ç |
| **CLI-1**  | ‚úÖ     | `--mode gcm` –¥–æ–±–∞–≤–ª–µ–Ω –≤ CLI |
| **CLI-2**  | ‚úÖ     | `--aad DATA` –¥–æ–±–∞–≤–ª–µ–Ω, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, hex-—Ñ–æ—Ä–º–∞—Ç |
| **CLI-3**  | ‚úÖ     | GCM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π 12-–±–∞–π—Ç–æ–≤—ã–π nonce |
| **CLI-4**  | ‚úÖ     | Nonce —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ (–ø–µ—Ä–≤—ã–µ 12 –±–∞–π—Ç) –∏–ª–∏ —á–µ—Ä–µ–∑ `--iv` |
| **CLI-5**  | ‚úÖ     | –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è, exit code 1 |
| **AEAD-1** | ‚ö†Ô∏è     | Encrypt-then-MAC –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (bonus) |
| **AEAD-2** | ‚úÖ     | GCM —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –Ω—É–ª—è –ø–æ NIST SP 800-38D |
| **AEAD-3** | ‚úÖ     | –£–º–Ω–æ–∂–µ–Ω–∏–µ –≤ GF(2^128) —Å –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–º –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–º x^128 + x^7 + x^2 + x + 1 |
| **AEAD-4** | ‚úÖ     | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ nonce 12 –±–∞–π—Ç, AAD –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã, plaintext –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã |
| **AEAD-5** | ‚úÖ     | Tag 16 –±–∞–π—Ç, —Ñ–æ—Ä–º–∞—Ç: nonce (12) || ciphertext || tag (16) |
| **AEAD-6** | ‚úÖ     | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–≥–∞ –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º plaintext, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ |
| **IO-1**   | ‚úÖ     | –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: 12-–±–∞–π—Ç–æ–≤—ã–π nonce || ciphertext || 16-–±–∞–π—Ç–æ–≤—ã–π tag |
| **IO-2**   | ‚úÖ     | –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥–∞: nonce (12) || ciphertext || tag (16) |
| **IO-3**   | ‚úÖ     | –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è/—É–¥–∞–ª—è–µ—Ç—Å—è |
| **IO-4**   | ‚úÖ     | AAD –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ binary string |
| **TEST-1** | ‚ö†Ô∏è     | NIST SP 800-38D —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ (–±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç) |
| **TEST-2** | ‚úÖ     | Round-trip —Ç–µ—Å—Ç: `test_gcm_basic_encrypt_decrypt` |
| **TEST-3** | ‚úÖ     | AAD tamper test: `test_gcm_wrong_aad_fails`, `test_cli_gcm_wrong_aad_fails` |
| **TEST-4** | ‚úÖ     | Ciphertext tamper test: `test_gcm_tampered_ciphertext_fails`, `test_cli_gcm_tampered_file_fails` |
| **TEST-5** | ‚úÖ     | Nonce uniqueness: `test_gcm_nonce_uniqueness` |
| **TEST-6** | ‚úÖ     | Empty AAD: `test_gcm_empty_aad` |
| **TEST-7** | ‚úÖ     | Large AAD: `test_gcm_large_aad` |
| **TEST-8** | ‚ö†Ô∏è     | OpenSSL interoperability ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ (—Ñ–æ—Ä–º–∞—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º) |
| **TEST-9** | ‚ö†Ô∏è     | Encrypt-then-MAC —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω) |

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ Sprint 6

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω GCM (Galois/Counter Mode) —Å –Ω—É–ª—è –ø–æ NIST SP 800-38D.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞ GF(2^128) —Å –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–º –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–º x^128 + x^7 + x^2 + x + 1.
- –†–∞—Å—à–∏—Ä–µ–Ω CLI –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `--mode gcm` –∏ `--aad`.
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω—ã nonce 12 –±–∞–π—Ç, tag 16 –±–∞–π—Ç, AAD –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã.
- –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è).
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–º–µ–Ω—ã.
- README –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ GCM –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **GCM-SHA256** ‚Äî –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ NIST SP 800-38D
2. **CLI –∫–æ–º–∞–Ω–¥—ã:**
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: `--algorithm aes --mode gcm --encrypt --key <key> [--aad <aad>] --input <file> --output <file>`
   - –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: `--algorithm aes --mode gcm --decrypt --key <key> [--aad <aad>] --input <file> --output <file>`
3. **–¢–µ—Å—Ç—ã:**
   - –ë–∞–∑–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
   - –†–∞–±–æ—Ç–∞ —Å AAD
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ AAD
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–º–µ–Ω—ã ciphertext/tag
   - –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å nonce
   - –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –∏ AAD
   - CLI —Ç–µ—Å—Ç—ã

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å AAD
python -m pycryptocore.cli --algorithm aes --mode gcm --encrypt --key 00112233445566778899aabbccddeeff --aad aabbccddeeff --input message.txt --output encrypted.bin

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º AAD
python -m pycryptocore.cli --algorithm aes --mode gcm --decrypt --key 00112233445566778899aabbccddeeff --aad aabbccddeeff --input encrypted.bin --output decrypted.txt
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å AAD (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–º–µ–Ω—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å nonce
- ‚úÖ –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
- ‚úÖ CLI –∫–æ–º–∞–Ω–¥—ã

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

- **–ê–ª–≥–æ—Ä–∏—Ç–º**: AES-128 –≤ —Ä–µ–∂–∏–º–µ CTR –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **GHASH**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –≤ GF(2^128)
- **Nonce**: 12 –±–∞–π—Ç (96 –±–∏—Ç), –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ
- **Tag**: 16 –±–∞–π—Ç (128 –±–∏—Ç)
- **–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞**: nonce (12) || ciphertext || tag (16)

