# Changelog

Все значимые изменения в проекте CryptoCore документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект следует [Semantic Versioning](https://semver.org/lang/ru/).

## [0.1.0] - 2024-12-19

### Добавлено

#### Sprint 8 (M8) - Polish & Documentation
- **Документация:**
  - Добавлен `docs/API.md` - полная документация API библиотеки
  - Добавлен `docs/USERGUIDE.md` - руководство пользователя
  - Добавлен `docs/DEVELOPMENT.md` - руководство для разработчиков
  - Добавлен `CHANGELOG.md` - история изменений
  - Добавлен `CONTRIBUTING.md` - руководство для контрибьюторов
  - Добавлен `SECURITY.md` - политика безопасности
  - Обновлен `README.md` с полной информацией о проекте
  - Добавлен `SETUP_UBUNTU_24_04.md` - инструкция по установке на чистую Ubuntu
  - Добавлен `COMMANDS_CHEATSHEET.md` - краткая шпаргалка команд

- **Тестирование:**
  - Полный набор pytest тестов (58 тестов)
  - Тесты интероперабельности с OpenSSL
  - Тесты для всех режимов AES (ECB, CBC, CFB, OFB, CTR, GCM)
  - Тесты для всех криптографических примитивов (SHA-256, SHA3-256, HMAC, CMAC, PBKDF2)
  - Негативные тесты (обработка ошибок)
  - Оптимизация тестов PBKDF2 для ускорения выполнения

- **Качество кода:**
  - Добавлен `.gitignore` для исключения артефактов сборки и тестовых файлов
  - Удалены временные тестовые файлы
  - Улучшена обработка ошибок в `run_tests.py`
  - Исправлена ошибка записи файла при дешифровании ECB

#### Sprint 7 (M7) - Key Derivation Functions
- **KDF (Key Derivation Functions):**
  - Реализован PBKDF2-HMAC-SHA256 с нуля (RFC 2898)
  - Реализована иерархия ключей (derive_key)
  - CLI команда `derive` для генерации ключей из паролей
  - Поддержка произвольных длин ключей и солей
  - Автоматическая генерация соли при необходимости

- **CLI:**
  - Новый подкоманда `cryptocore derive`
  - Параметры: `--password`, `--salt`, `--iterations`, `--length`, `--algorithm`
  - Вывод в формате `KEY_HEX SALT_HEX`

#### Sprint 6 (M6) - Authenticated Encryption
- **GCM (Galois/Counter Mode):**
  - Реализация AES-GCM с нуля (NIST SP 800-38D)
  - Galois Field умножение в GF(2^128)
  - Поддержка Associated Data (AAD)
  - Катастрофический отказ при ошибке аутентификации
  - 12-байтовый nonce (вместо 16-байтового IV)

- **CLI:**
  - Поддержка режима `--mode gcm`
  - Параметр `--aad` для аутентифицированных данных
  - Автоматическая проверка аутентификации при дешифровании

#### Sprint 5 (M5) - Message Authentication Codes
- **HMAC:**
  - Реализация HMAC-SHA256 с нуля (RFC 2104)
  - Использование собственной реализации SHA-256
  - Поддержка ключей произвольной длины
  - Обработка ключей длиннее/короче блока

- **AES-CMAC:**
  - Реализация AES-CMAC с нуля (NIST SP 800-38B)
  - Генерация подключей
  - Корректная обработка последнего блока

- **CLI:**
  - Расширение команды `dgst` с флагом `--hmac`
  - Расширение команды `dgst` с флагом `--cmac`
  - Параметр `--verify` для проверки HMAC/CMAC
  - Поддержка ключей в hex формате

#### Sprint 4 (M4) - Hash Functions
- **SHA-256:**
  - Реализация SHA-256 с нуля (NIST FIPS 180-4)
  - Merkle-Damgård конструкция
  - PKCS#7 padding
  - Обработка файлов произвольного размера (chunking)

- **SHA3-256:**
  - Реализация через `hashlib` (NIST FIPS 202)
  - Поддержка больших файлов

- **CLI:**
  - Новая подкоманда `cryptocore dgst`
  - Параметры: `--algorithm sha256|sha3-256`, `--input`, `--output`
  - Вывод в формате `HASH_VALUE INPUT_FILE_PATH`

#### Sprint 3 (M3) - Cryptographically Secure Random Number Generation
- **CSPRNG:**
  - Модуль `csprng.py` с функцией `generate_random_bytes()`
  - Использование `os.urandom()` для криптографически стойкой генерации
  - Интеграция в генерацию ключей и IV

- **CLI:**
  - Параметр `--key` стал опциональным при шифровании
  - Автоматическая генерация и вывод ключа при отсутствии `--key`
  - Предупреждение о слабых ключах (детектор слабых ключей)
  - Обязательный `--key` при дешифровании

#### Sprint 2 (M2) - Multiple Encryption Modes
- **Режимы шифрования:**
  - Реализация CBC (Cipher Block Chaining)
  - Реализация CFB (Cipher Feedback)
  - Реализация OFB (Output Feedback)
  - Реализация CTR (Counter)
  - Все режимы реализованы с нуля (кроме базового AES примитива)

- **IV (Initialization Vector):**
  - Автоматическая генерация IV при шифровании
  - IV prepended к шифротексту
  - Чтение IV из файла или CLI при дешифровании
  - 16-байтовый IV для всех режимов

- **CLI:**
  - Поддержка `--mode cbc|cfb|ofb|ctr`
  - Параметр `--iv` для дешифрования
  - Валидация IV

- **Интероперабельность:**
  - Тесты совместимости с OpenSSL для всех режимов
  - Корректная работа с форматом файлов OpenSSL

#### Sprint 1 (M1) - Core Block Cipher Operations
- **AES-128:**
  - Реализация ECB (Electronic Codebook) режима
  - Использование `pycryptodome` для базового AES примитива
  - PKCS#7 padding для выравнивания блоков

- **CLI:**
  - Базовая структура CLI с `argparse`
  - Параметры: `--algorithm`, `--mode`, `--encrypt/--decrypt`, `--key`, `--input`, `--output`
  - Ключ в hex формате
  - Валидация всех аргументов
  - Автоматическое имя выходного файла

- **Файловый I/O:**
  - Чтение/запись бинарных файлов
  - Обработка ошибок файловой системы
  - Поддержка текстовых и бинарных файлов

- **Тестирование:**
  - Базовый round-trip тест
  - Тест интероперабельности с OpenSSL (ECB)

### Изменено

- **Sprint 8:**
  - Оптимизированы тесты PBKDF2 (уменьшено количество итераций с 100k до 1k для ускорения)
  - Исправлена ошибка записи файла при дешифровании ECB без пароля
  - Улучшена обработка ошибок в `run_tests.py`

### Исправлено

- **Sprint 8:**
  - Исправлена ошибка `IndentationError` в `run_tests.py`
  - Исправлена ошибка отсутствия выходного файла при дешифровании ECB
  - Исправлен тест PBKDF2 с неверным ожидаемым значением

### Безопасность

- Все случайные значения генерируются через криптографически стойкий CSPRNG (`os.urandom`)
- Реализована проверка аутентификации перед дешифрованием (GCM)
- Нет hardcoded ключей или паролей
- Корректная обработка чувствительных данных
- Предупреждения о слабых ключах

---

## Формат версий

- **MAJOR** - несовместимые изменения API
- **MINOR** - новая функциональность с обратной совместимостью
- **PATCH** - исправления ошибок с обратной совместимостью

## Ссылки

- [Репозиторий](https://github.com/dankapust/CryptoCore) - исходный код

---

**Примечание:** После создания релиза v0.1.0 на GitHub, ссылка на конкретный релиз будет добавлена здесь.

