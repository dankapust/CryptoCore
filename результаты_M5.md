# ## üìä –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Sprint 5 (M5)

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ |
| ---------- | ------ | -------------- |
| **STR-1**  | ‚úÖ     | –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è M1‚ÄìM4 |
| **STR-2**  | ‚úÖ     | `pycryptocore/mac/` —Å `hmac.py`, `__init__.py` |
| **STR-3**  | ‚úÖ     | README.md: --hmac, --key, –ø—Ä–∏–º–µ—Ä—ã, —Å–≤–æ–π—Å—Ç–≤–∞ HMAC |
| **CLI-1**  | ‚úÖ     | –§–ª–∞–≥ `--hmac` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `dgst` –∫–æ–º–∞–Ω–¥—É |
| **CLI-2**  | ‚úÖ     | `--key` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ `--hmac`, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞ |
| **CLI-3**  | ‚úÖ     | –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: `HMAC_VALUE  INPUT_FILE_PATH` |
| **CLI-4**  | ‚úÖ     | `--verify FILE` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ HMAC, exit code 0/1 |
| **CLI-5**  | ‚úÖ     | –§–ª–∞–≥ `--cmac` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `dgst` –∫–æ–º–∞–Ω–¥—É |
| **MAC-1**  | ‚úÖ     | HMAC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –Ω—É–ª—è –ø–æ RFC 2104, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SHA-256 |
| **MAC-2**  | ‚úÖ     | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–π: —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö, –ø–∞–¥–¥–∏–Ω–≥ –∫–æ—Ä–æ—Ç–∫–∏—Ö |
| **MAC-3**  | ‚úÖ     | –§–æ—Ä–º—É–ª–∞: `HMAC(K, m) = H((K ‚äï opad) || H((K ‚äï ipad) || m))` |
| **MAC-4**  | ‚úÖ     | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª—é—á–µ–π –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã |
| **MAC-5**  | ‚úÖ     | –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (—á–∞–Ω–∫–∏) |
| **MAC-6**  | ‚úÖ     | AES-CMAC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –Ω—É–ª—è –ø–æ NIST SP 800-38B |
| **IO-1**   | ‚úÖ     | –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ `rb`, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞–Ω–∫–∞–º–∏ |
| **IO-2**   | ‚úÖ     | –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞ —Å –æ–∂–∏–¥–∞–µ–º—ã–º HMAC (–≥–∏–±–∫–∏–π —Ñ–æ—Ä–º–∞—Ç) |
| **IO-3**   | ‚úÖ     | `--output` –ø–∏—à–µ—Ç HMAC –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ |
| **TEST-1** | ‚úÖ     | RFC 4231 —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã 1-4: `tests/test_hmac.py` |
| **TEST-2** | ‚úÖ     | –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —É—Ç–∏–ª–∏—Ç–æ–π |
| **TEST-3** | ‚úÖ     | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ: `test_cli_hmac_verify_failure_tampered_file` |
| **TEST-4** | ‚úÖ     | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞: `test_cli_hmac_verify_failure_wrong_key` |
| **TEST-5** | ‚úÖ     | –¢–µ—Å—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–ª—é—á–µ–π (16, 64, 100 –±–∞–π—Ç) |
| **TEST-6** | ‚úÖ     | HMAC –¥–ª—è –ø—É—Å—Ç–æ–≥–æ —Ñ–∞–π–ª–∞: `test_hmac_empty_file` |
| **TEST-7** | ‚úÖ     | –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤: `test_hmac_chunk_processing` |
| **TEST-8** | ‚úÖ     | NIST SP 800-38B —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã: `tests/test_cmac.py` |

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ Sprint 5

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω HMAC —Å –Ω—É–ª—è –ø–æ RFC 2104, –∏—Å–ø–æ–ª—å–∑—É—è SHA-256 –∏–∑ Sprint 4.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω AES-CMAC —Å –Ω—É–ª—è –ø–æ NIST SP 800-38B (bonus-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ).
- –†–∞—Å—à–∏—Ä–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `dgst` —Ñ–ª–∞–≥–∞–º–∏ `--hmac`, `--cmac`, `--key`, `--verify` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ MAC.
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω—ã –∫–ª—é—á–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –¥–ª—è HMAC –∏ 16-–±–∞–π—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –¥–ª—è CMAC.
- –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏.
- –í—Å–µ —Ç–µ—Å—Ç—ã RFC 4231 (HMAC) –∏ NIST SP 800-38B (CMAC) –ø—Ä–æ—Ö–æ–¥—è—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
- README –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ HMAC –∏ CMAC.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **HMAC-SHA256** ‚Äî –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ RFC 2104
2. **AES-CMAC** ‚Äî –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ NIST SP 800-38B
3. **CLI –∫–æ–º–∞–Ω–¥—ã:**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC: `dgst --algorithm sha256 --hmac --key <key> --input <file>`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC: `dgst --algorithm sha256 --hmac --key <key> --input <file> --verify <hmac_file>`
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CMAC: `dgst --algorithm sha256 --cmac --key <key> --input <file>`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ CMAC: `dgst --algorithm sha256 --cmac --key <key> --input <file> --verify <cmac_file>`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª: `--output <file>`
3. **–¢–µ—Å—Ç—ã:**
   - RFC 4231 —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã (1-4)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞)
   - –†–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–ª—é—á–µ–π
   - –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC
python -m pycryptocore.cli dgst --algorithm sha256 --hmac --key 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b --input test.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC
python -m pycryptocore.cli dgst --algorithm sha256 --hmac --key 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b --input test.txt --verify test.hmac
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ HMAC: RFC 4231 —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã (4 —Ç–µ—Å—Ç–∞)
- ‚úÖ HMAC: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ (3 —Ç–µ—Å—Ç–∞)
- ‚úÖ HMAC: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (1 —Ç–µ—Å—Ç)
- ‚úÖ HMAC: CLI –∫–æ–º–∞–Ω–¥—ã (5 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ HMAC: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (2 —Ç–µ—Å—Ç–∞)
- ‚úÖ CMAC: NIST SP 800-38B —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã (1 —Ç–µ—Å—Ç)
- ‚úÖ CMAC: –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (6 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ CMAC: CLI –∫–æ–º–∞–Ω–¥—ã (5 —Ç–µ—Å—Ç–æ–≤)

